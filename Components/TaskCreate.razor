
@inject ITaskService _taskService
@inject ISnackbar _alert
@inject NavigationManager Navigation

<MudDialog DisableSidePadding="true">
    <DialogContent>
        <MudContainer>
            <MudTextField T="string" Label="Nombre de tu proyecto" Variant="Variant.Text" @bind-Value="Name"/>
            <MudTextField T="string" Label="DescripciÃ³n" Variant="Variant.Text" @bind-Value="Desc"  Lines="3"/>
            <MudSelect Margin="Margin.Dense" T="string" Label="Estado" Variant="Variant.Outlined" @bind-Value="State">
                <MudSelectItem Value="@("Pendiente")" />
                <MudSelectItem Value="@("Completada")" />
                <MudSelectItem Value="@("En Proceso")" />
            </MudSelect>
        </MudContainer>
    </DialogContent>
    <DialogActions>
        <MudButton Color="Color.Primary" OnClick="Ok">Cerrar</MudButton>
        <MudButton Color="Color.Success" OnClick="SendData">Enviar</MudButton>
    </DialogActions>
</MudDialog>

@code{

    [CascadingParameter] 
    MudDialogInstance MudDialog { get; set; }

    [Parameter]
    public int IdProject {get;set;}


    public string Name {get;set;} = String.Empty;

    public string Desc {get;set;} = String.Empty;

     public string State {get;set;}= String.Empty;
    

    public Taskes model {get;set;} = new Taskes();



        private void Ok()
    {
        MudDialog.Close(DialogResult.Ok(true));
    }

    private async Task SendData()
    {
       model.TaskName = Name;
       model.TaskDescription = Desc;
       model.TaskState = State;
      model.TaskProjectId = IdProject;
       var created =  await _taskService.CreateTask(model);
       if(created != null)
       {
        _alert.Add("Acabas de crear una tarea nuevo", Severity.Success);
        MudDialog.Close(DialogResult.Ok(true));
        
        Navigation.NavigateTo($"/tasks/{created.TaskProjectId}/created");
       }

       
    }



}